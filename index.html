<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Exam Platform</title>
    <link rel="stylesheet" href="assets/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Loading overlay critical CSS */
        #app-loader {
            position: fixed;
            inset: 0;
            background: #0f172a;
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-family: sans-serif;
            transition: opacity 0.5s;
        }

        .hidden {
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>

<body>

    <!-- App Loader -->
    <div id="app-loader">
        <div class="loader-content">
            <i class="fas fa-circle-notch fa-spin fa-3x"></i>
            <p style="margin-top: 1rem;">Loading Exam Engine...</p>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="container nav-content">
            <div class="logo">
                <span
                    style="background: white; color: #0f172a; padding: 2px 10px; border-radius: 8px; margin-right: 8px; font-weight: 900; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">Z+</span>
                <span>Exam<span class="highlight">Platform</span></span>
            </div>
            <div class="nav-links">
                <a href="#" id="nav-home" class="active" data-i18n="home">Home</a>
                <a href="#" id="nav-subjects" data-i18n="sections">Sections</a>
                <button id="langToggle" class="btn-secondary"
                    style="padding: 5px 15px; font-size: 0.9rem;">عربي</button>
                <a href="https://github.com/ZplusBank/zplusbank.github.io" target="_blank" class="github-link"><i
                        class="fab fa-github"></i></a>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main id="app" class="container">
        <!-- Views will be injected here by renderer.js -->
        <section id="home-view" class="view active">
            <header class="hero">
                <h1><span data-i18n="hero_title_pre">Master Your Skills with</span> <br><span class="gradient-text"
                        data-i18n="hero_title_highlight">Static Exams</span></h1>
                <p class="subtitle" data-i18n="hero_subtitle">No login, free, fast exam platform built with Z+ Team</p>
                <button id="btn-explore" class="btn-primary" data-i18n="explore_btn">Explore Sections</button>
            </header>

            <div class="subjects-grid">
                <!-- Subject cards will be loaded here -->
            </div>
        </section>

        <!-- Sections View with Search -->
        <section id="sections-view" class="view hidden">
            <div class="section-header" style="margin-bottom: 2rem; text-align: center;">
                <h2 data-i18n="sections">Sections</h2>
                <div class="search-container" style="max-width: 500px; margin: 1rem auto; padding: 0 1rem;">
                    <div class="search-box">
                        <i class="fas fa-search search-icon"></i>
                        <input class="search-input" type="text" id="section-search" placeholder="Search exams...">
                    </div>
                </div>
            </div>

            <div class="subjects-grid">
                <!-- Same grid used for filtering -->
            </div>
        </section>

        <section id="exam-view" class="view hidden">
            <div class="exam-header">
                <div class="exam-info">
                    <h2 id="exam-title">Exam Title</h2>
                    <span id="exam-timer" class="timer-badge">00:00</span>
                </div>
                <div class="progress-bar">
                    <div id="progress-fill" style="width: 0%"></div>
                </div>
            </div>

            <div id="question-container" class="question-container">
                <!-- Dynamic Question Content -->
            </div>

            <div class="exam-controls">
                <button id="btn-prev" class="btn-secondary" disabled data-i18n="prev_btn">Previous</button>
                <button id="btn-next" class="btn-secondary" data-i18n="next_btn">Next</button>
                <button id="btn-submit" class="btn-primary hidden" data-i18n="submit_btn">Submit Exam</button>
            </div>
        </section>

        <section id="results-view" class="view hidden">
            <div class="results-card">
                <div class="score-circle">
                    <svg viewBox="0 0 36 36" class="circular-chart">
                        <path class="circle-bg" stroke-dasharray="100, 100"
                            d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                        <path id="score-circle-path" class="circle" stroke-dasharray="0, 100"
                            d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                        <text x="18" y="20.35" class="percentage" id="score-text">0%</text>
                    </svg>
                </div>
                <h2 data-i18n="exam_completed">Exam Completed!</h2>
                <p id="result-message">Great job!</p>
                <div class="result-actions">
                    <button id="btn-retry" class="btn-primary" data-i18n="retry_btn">Retry Exam</button>
                    <button id="btn-home" class="btn-secondary" data-i18n="back_home_btn">Back to Home</button>
                </div>
            </div>
        </section>
    </main>

    <!-- Scripts -->
    <script>
        // Localization Logic
        const translations = {
            en: {
                home: "Home",
                sections: "Sections",
                hero_title_pre: "Master Your Skills with",
                hero_title_highlight: "Static Exams",
                hero_subtitle: "No login, free, fast exam platform built with Z+ Team",
                explore_btn: "Explore Sections",
                prev_btn: "Previous",
                next_btn: "Next",
                submit_btn: "Submit Exam",
                exam_completed: "Exam Completed!",
                retry_btn: "Retry Exam",
                back_home_btn: "Back to Home",
                lang_toggle: "عربي",
                search_placeholder: "Search exams..."
            },
            ar: {
                home: "الرئيسية",
                sections: "الأقسام",
                hero_title_pre: "أتقن مهاراتك مع",
                hero_title_highlight: "امتحانات تفاعلية",
                hero_subtitle: "منصة امتحانات سريعة، مجانية، بدون تسجيل، مطورة بواسطة فريق Z+",
                explore_btn: "تصفح الأقسام",
                prev_btn: "السابق",
                next_btn: "التالي",
                submit_btn: "إرسال الامتحان",
                exam_completed: "تم الانتهاء من الامتحان!",
                retry_btn: "إعادة المحاولة",
                back_home_btn: "العودة للرئيسية",
                lang_toggle: "English"
            }
        };

        function setLanguage(lang) {
            document.documentElement.lang = lang;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            localStorage.setItem('lang', lang);

            // Update text content
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[lang] && translations[lang][key]) {
                    el.textContent = translations[lang][key];
                }
            });

            // Update placeholders (search field, etc.)
            const searchInput = document.getElementById('section-search');
            if (searchInput && translations[lang] && translations[lang].search_placeholder) {
                searchInput.placeholder = translations[lang].search_placeholder;
            }

            // Toggle button text
            document.getElementById('langToggle').textContent = translations[lang].lang_toggle;

            // Adjust Font for Arabic
            if (lang === 'ar') {
                document.body.style.fontFamily = "'Tajawal', 'Outfit', sans-serif";
            } else {
                document.body.style.fontFamily = "'Outfit', sans-serif";
            }
        }

        document.getElementById('langToggle').addEventListener('click', () => {
            const currentLang = document.documentElement.lang || 'en';
            const newLang = currentLang === 'en' ? 'ar' : 'en';
            setLanguage(newLang);
        });

        // Init Language
        const savedLang = localStorage.getItem('lang') || 'ar';
        setLanguage(savedLang);
    </script>
    <script type="module">
        // Main entry point logic can go here or in a main.js
        import { initApp } from './engine/renderer.js';
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>

</html>